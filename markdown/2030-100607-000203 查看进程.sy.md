---
show: step

version: 1.0
enable_checker: true
---

# æŸ¥çœ‹è¿›ç¨‹

## å›å¿†ä¸Šæ¬¡å†…å®¹

- æƒ³è¦ç›´æ¥æ‰§è¡Œ`timer`
	- å¯ä»¥æŠŠ`timer`æ”¾å…¥`~/MyTimer`ä¸‹é¢
	- å¯ä»¥ä¿®æ”¹$PATHè·¯å¾„
		- æŠŠ`ç”¨æˆ·ç›®å½•ï½`æ·»åŠ åˆ°`$PATH`
		- è¿™æ ·`timer`ä¸ç”¨åŠ è·¯å¾„å°±å¯ä»¥è¢«æ‰¾åˆ°
		- äºæ˜¯å¯ä»¥è¢«æ‰§è¡Œäº†
	- å¯ä»¥ä¿®æ”¹`$CLASSPATH`
		- è¿™æ ·æ‰€æœ‰åœ¨é‡Œé¢çš„`class`å°±å¯ä»¥æ‰¾åˆ°äº†
- å¯ä»¥æŠŠè„šæœ¬çš„ä½ç½®æ”¾åˆ°`zshçš„PATH`ä¸­
	- è®¾ç½®`~/.zshrc`å°±å¯ä»¥é…ç½®zsh
	- `rc`çš„æ„æ€æ˜¯`runcomannd`
- åœ¨å½“å‰è·¯å¾„è¿è¡Œtimer
	- é€šè¿‡shellæŠŠ/usr/lib/jvm/java-8-openjdk-amd64/bin/javaä»ç¡¬ç›˜è°ƒç”¨åˆ°å†…å­˜
	- æˆä¸ºä¸€ä¸ªè¿›ç¨‹
	- <kbd>ctrl</kbd>+<kbd>c</kbd>ç»“æŸè¿›ç¨‹
- æˆ‘æƒ³çœ‹åˆ°è¿™ä¸ªè¿›ç¨‹`java`å¯èƒ½å—ï¼ŸğŸ¤”


### è¿›è¡Œæœç´¢

- å¦‚æœæˆ‘æƒ³æŸ¥çœ‹è¿›ç¨‹ï¼Œä¹Ÿéœ€è¦è¿è¡Œç›¸åº”çš„æŸ¥çœ‹å‘½ä»¤
- ä½†æ˜¯å¦‚æœ`timer`æŒç»­è¾“å‡ºæ—¶é—´
- æˆ‘æ˜¯æ²¡æœ‰åŠæ³•æŸ¥çœ‹è¿›ç¨‹çš„
- æˆ‘éœ€è¦æŠŠ`timer`è½¬åˆ°åå°
- ç„¶åæŸ¥è¯¢è¿›ç¨‹ä¿¡æ¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210221-1613901469592)


### åˆ‡åˆ°åå° 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210221-1613901550053)

- åˆ‡æ¢çš„æ–¹æ³•æ¯”è¾ƒç®€å•
- <kbd>ctrl</kbd>+<kbd>z</kbd>æŠŠå½“å‰è¿›ç¨‹åˆ‡æ¢åˆ°åå°
- `fg`å‘½ä»¤æŠŠåå°è¿›ç¨‹æ”¾å›å‰å°
- `fg`çš„æ„æ€æ˜¯`f`ront`g`round(å‰å°)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210311-1615450961612)


### æŸ¥è¯¢è¿›ç¨‹

- æœç´¢`debianè¿›ç¨‹æŸ¥è¯¢`
- æ‰¾åˆ°ç›¸åº”çš„å†…å®¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210221-1613901837312)


```shell
#æŸ¥è¯¢è¿›ç¨‹,æˆ‘ä»¬ä¸ç”¨æ‰€æœ‰çš„
#åªè¦å’Œè¿™ä¸ªshellç›¸å…³çš„
#æŠŠeå»æ‰
ps -lf
```

### å…·ä½“æŸ¥è¯¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210311-1615451026444)

-  è¿›ç¨‹ç›¸å…³çš„4ä¸ªè¿›ç¨‹
	- zsh(å½“å‰çš„shellç¯å¢ƒ)
- åé¢çš„æ˜¯ä»€ä¹ˆï¼Ÿçœ‹ä¸åˆ°ï¼Ÿ
- è¾“å‡ºè½¬å‘åˆ°æ–‡æœ¬

```
ps -lf > ps
vi ps
```
### å…·ä½“è¿›ç¨‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210313-1615635353363)

- zsh æ˜¯shell
- sh ç”¨æ¥æ‰§è¡Œtimerçš„
- java timer å…·ä½“çš„è¿è¡Œè¿›ç¨‹

### å±‚çº§å…³ç³»

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210318-1616077610896)

- ps -lf
	- `pid`æ˜¯æŒ‡è¿›ç¨‹çš„`id`
		- `p`rocess `id`
	- `ppid`æ˜¯æŒ‡`çˆ¶`è¿›ç¨‹`id`
		-  `p`arent `p`rocess `id`
	-  `ps`å’Œ`sh`éƒ½æ˜¯`zsh`çš„å­è¿›ç¨‹
	-  `java`æ˜¯`sh`çš„å­è¿›ç¨‹
	-  `zsh`æ˜¯`java timer`çš„å§¥å§¥çº§è¿›ç¨‹
	-  `java timer`æ˜¯`zsh`çš„å­™å­çº§è¿›ç¨‹

### å†…å­˜å ç”¨ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210313-1615635540513)

-  javaè¿™ä¸ªè¿›ç¨‹å å†…å­˜`556343`ä¸ªPage
-  æ¯ä¸ªPageå¤§æ¦‚4K

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210311-1615454528781)

-  æ€»å…±å¤§æ¦‚2Gå·¦å³
	-  è¿™ä¸ªæ–‡ä»¶ä¸æ˜¯æœ¬èº«æ‰å‡ Kä¹ˆ
	-  éƒ½è£…è¿›å†…å­˜ä¹Ÿå°±æ˜¯å‡ K
	-  ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤§å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210311-1615454662036)

### å†…å­˜å®¹é‡çš„åŸå› 

- é™¤äº†åŸºç¡€çš„éƒ¨åˆ†ä¹‹å¤–
- è¿˜æœ‰æ–°åŠ è½½çš„éƒ¨åˆ†
- åŸºç¡€çš„å°±æ˜¯
	- System.out.printè¿™äº›
- æ–°åŠ è½½çš„åŒ…æ‹¬
	- importè¿›æ¥çš„ç±»
	- æå‰åˆ†é…çš„å†…å­˜ç©ºé—´
	- æ¯”å¦‚å¯ä»¥æå‰é¢„åˆ†é…å †å†…å­˜ç©ºé—´å¤§å°
	- é¢„åˆ†é…ä¹‹åå°±æ˜¯756159ä¸ªPageäº†

### ä¿®æ”¹
```
#è®¾ç½®jvmå †ç©ºé—´çš„ä½“ç§¯
java -Xms1G -Xmx1G timer
```

- Xmsè®¾ç½®åˆå§‹å †(heap)å¤§å°
- Xmxè®¾ç½®æœ€å¤§å †(heap)å¤§å°
- å¯ä»¥ç”¨`man java`æŸ¥æ‰¾åˆ°å‚æ•°ä¿¡æ¯


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210313-1615635919374)
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210313-1615635928638)

### å¯¹æ¯”ç»“æœ
```
ps -lf
```

- javaæ‰€å ç©ºé—´å¢å¤§äº†
- åŸæ¥æ˜¯2Gï¼Œç°åœ¨æ˜¯3G


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210311-1615454738084)

- å¯ä»¥å‹ç¼©jvmçš„å†…å­˜å ç”¨å—ï¼Ÿ

### å‹ç¼©ç©ºé—´

- é‚£æˆ‘å¯ä»¥å‹ç¼©jvmæ‰€å çš„å†…å­˜å—ï¼Ÿ
- æˆ‘è¯•è¯•ç”¨1Kæ¥è¿è¡Œjvm
- 

```
java -Xms1K -Xmx1K timer
```

- ç»“æœæ˜¯jvmæ ¹æœ¬ä¸å¤Ÿå¯åŠ¨çš„
- jvmæœ¬èº«éœ€è¦ä¸€å®šçš„ç©ºé—´
- ä¸åªæ˜¯ç”³è¯·è™šæ‹Ÿæœºå†…å­˜

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210313-1615620335858)

- 1Kæ ¹æœ¬ä¸å¤ŸèŠ±

### å†æ¬¡å°è¯•

```
java -Xms1M -Xmx1M timer
```

- è®¾ç½®åˆå§‹å †(heap)å¤§å°ä¸º1M

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210318-1616077938902)

- ç°åœ¨æ˜¯493675ä¸ªPageï¼ŒåŸæ¥æ˜¯756159ä¸ªPage
- å˜å°äº†
- ä½†æ˜¯ä»ç„¶æœ‰1Gå¤š
- å †ç©ºé—´1Mä¹Ÿéœ€è¦1Gå¤šï¼Ÿ

### çœŸå®æƒ…å†µ

- ä½†è¿™ä¸ªåªæ˜¯é¢„åˆ†é…
- å¹¶ä¸æ˜¯çœŸå®çš„åˆ†é…

```
ps -o ppid,sz,vsz,rss,cmd
```

- szå•ä½å°±æ˜¯page size=4kb
- vszå’Œrsså•ä½æ˜¯kb
- szå’Œvszæ˜¯è™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆå› å•ä½ä¸åŒvszæ•°å€¼æ˜¯szçš„4å€)
- rssæ‰æ˜¯çœŸå®å†…å­˜å ç”¨
- linuxåœ¨ç¨‹åºå®é™…ä½¿ç”¨ç”³è¯·çš„å†…å­˜æ—¶æ‰åˆ†é…ç‰©ç†å†…å­˜
- ç”³è¯·åè®¡å…¥vsz
- ä½¿ç”¨åè®¡å…¥rss

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210318-1616077987602)

- æ¬²åˆ†é…2G
- å®é™…å ç”¨äº†24M
- ç°åœ¨æˆ‘æƒ³æŠŠè¿™ä¸ª24Mçš„è¿›ç¨‹å¹²æ‰æ€ä¹ˆåŠï¼Ÿ
- æœç´¢ä¸€ä¸‹


## æ€»ç»“

- æˆ‘ä»¬å¯ä»¥æŠŠ<kbd>ctrl</kbd>+<kbd>z</kbd>æŠŠå½“å‰è¿›ç¨‹åˆ‡æ¢åˆ°åå°
- ç”¨`fg`å¯æŠŠè¿›ç¨‹åˆ‡å›å‰å°
- `ps -lf`æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯
	- `java timer`å¤§æ¦‚24Mï¼Ÿ
- æˆ‘èƒ½æŠŠè¿™ä¸ªè¿›ç¨‹ç»“æŸå—ğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹